# AutoCAD 教科書連携プラン（標準＋応用）

このドキュメントは、リポジトリに追加された次の教材を AI CAD の機能設計・UI改善・AI会話フローに反映するための実行計画です。

- `autocad標準教科書.pdf`
- `autocad応用教科書.pdf`

## 目的

- AutoCAD 現役ユーザーが「いつもの操作体系」で移行できるようにする。
- 不足機能の実装優先度を、教材の学習順と現場インパクトの両方で決める。
- AIチャットを前提に、自然言語で「指定して直す」運用をプロダクト標準にする。

## 教材の使い方（開発チーム内ルール）

1. **標準教科書**を「初心者〜中級者が日常的に使う機能」の基準として扱う。
2. **応用教科書**を「実務効率化・図面品質・運用管理」の基準として扱う。
3. 教材で紹介される機能は、以下の3分類で台帳化する。
   - 実装済み
   - UIのみ不足（機能はあるが導線が弱い）
   - 未実装
4. 未実装は `docs/autocad-gap-analysis.md` と突き合わせ、重複を統合する。

## 実装優先度（移行インパクト順）

### P0（最優先）

- 作図・修正の基本反復系
  - 端点/中点/交点スナップ
  - ポリライン編集（追加・削除・閉合）
  - トリム/延長の操作性改善
- 寸法・注記の実務最低ライン
  - 寸法スタイル管理
  - 引出線（MLeader相当の簡易版）
- AI補助導線
  - チャットで「ここを○○mm伸ばす」「この壁芯を揃える」を即反映

#### P0 実装進捗（2026-02 更新）

- [x] P0-1: 端点/中点/交点スナップ
- [x] P0-2: ポリライン編集（追加・削除・閉合）
- [x] P0-3: トリム/延長の操作性改善
- [x] P0-4: 寸法スタイル管理
- [x] P0-5: 引出線（MLeader相当の簡易版）
- [x] P0-6: AIチャット編集コマンド（draw + mutate）

### P1（次点）

#### P1 実装進捗（2026-02 更新）

- [x] P1-0: ByLayer（色・線種・線幅）基礎対応

- レイヤー実務
  - ByLayer（色・線種・線幅）
  - レイヤー状態保存
- ブロック運用
  - シンボル再利用（Block）
  - 属性付きブロック（設備記号・部屋名）
- 入出力
  - DXF書き出し（R12ベースで開始）

### P2（中期）

- 図面管理・協調
  - Xref
  - レイアウト/印刷スタイル
  - 差分比較
- AI高度化
  - PDFチェックバックからの差分提案精度改善
  - 変更理由の説明（監査ログ）

## AIチャット運用テンプレート（実装時の基本プロンプト）

以下を UI のプリセット文として提供すると、AutoCADユーザーの移行摩擦を下げられる。

- 「この図面を AutoCAD 風の操作手順で修正して。必要ならコマンド名も併記して。」
- 「標準的な建築作図ルール（通り芯・寸法・注記）で不足点を列挙して。」
- 「この変更を最短手順で適用して。作図順序も示して。」
- 「応用教科書レベルの時短テクニックで、この操作を自動化して。」

## 定着のための UI 改善方針

- コマンドラインに **AutoCAD互換別名** を増やす（例: `L`, `PL`, `TR`, `EX`, `CO`）。
- ツールチップに「用途」「ショートカット」「AIに頼む例」を表示する。
- 右クリックメニューを「よく使う修正系」優先で再配置する。

## 直近の進め方

1. 本ドキュメントを起点に、教科書ベースの機能台帳を作成する。
2. 台帳の P0 項目から Issue 化して、小さく連続リリースする。
3. 各リリースで「AutoCADユーザー移行テスト」を実施し、詰まる操作を優先修正する。
4. P0〜P2完了後は、`docs/po3-po5-textbook-backlog.md` を次期計画の基準として運用する。

---

## P6〜P10 計画（標準教科書・応用教科書の次段）

> 前提: P0〜P5 により、主要作図・編集・出図・監査の基盤は利用可能。
> ここからは **「実務運用の摩擦ゼロ化」+「AutoCAD互換UIの仕上げ」+「AI協調の定着」** を段階的に進める。

### P6（操作互換の完成）

**目標**: AutoCAD経験者が、設定変更なしで操作を再現できる状態にする。

- コマンドライン互換
  - コマンド中オプション表示（`[Undo/Close/Arc/Length...]`）を標準化
  - 相対座標 `@dx,dy` / 極座標 `@length<angle` を全作図系へ拡張
- 右クリック運用
  - 「コマンド中 = Enter」「待機中 = コンテキストメニュー」を既定化
  - Shift+右クリックの一時OSNAPメニュー（END/MID/INT/CEN/PER/TAN/NEA）
- 動的入力
  - カーソル近傍の長さ・角度インライン入力（ON/OFF切替含む）

**DoD**
- AutoCAD利用者テストで「基本作図の手順差分が少ない」と評価される。

### P7（選択・編集の高密度化）

**目標**: 赤入れ反映や設計変更時の編集テンポを、現場で許容される水準へ上げる。

- 選択系の強化
  - Window / Crossing / Fence の完全実装
  - Selection cycling とグリップ編集（hot grip）
- 編集系の仕上げ
  - Stretch / Break / Join / Align を履歴連携込みで完成
  - TRIM/EXTEND の連続処理モード
- プロパティ運用
  - MATCHPROP + クイックプロパティパネル

**DoD**
- 1000〜3000要素の図面で、選択→編集の反復操作が体感的に詰まらない。

### P8（図面標準とテンプレート統制）

**目標**: 教科書どおりの図面品質を「人依存でなく」再現する。

- 標準テンプレート運用
  - 単位、文字スタイル、寸法スタイル、画層、印刷設定をテンプレート化
  - 業種別テンプレート（建築平面、詳細図、設備）
- 規約チェック
  - 命名規約・線種・注記高さの自動検査
  - 逸脱箇所をAIが修正候補として提示
- 教育導線
  - 「標準教科書準拠モード」「応用教科書準拠モード」のプリセット

**DoD**
- 新規図面作成時にテンプレート選択だけで初期品質を担保できる。

### P9（チーム協調とレビュー自動化）

**目標**: 個人作図から、レビュー駆動のチーム運用へ拡張する。

- 差分レビュー
  - 図面差分のセマンティック分類（作図/寸法/注記/レイヤー）
  - 変更理由テンプレート（誰が・なぜ・何を）
- 依存管理
  - Xref / フォント / 画像 / CTB依存診断の自動化
  - 参照切れの修復提案（相対パス優先）
- AIレビュー支援
  - レビューコメントの自動草案
  - 指摘→修正→再チェックのワンクリック循環

**DoD**
- レビュー会で「変更箇所特定」と「説明作成」の時間を明確に短縮できる。

### P10（AI CAD独自価値の完成）

**目標**: AutoCAD互換を維持しつつ、AI連動で明確に優位な体験を提供する。

- 意図ベース編集
  - 「壁芯通りを揃える」「この室を法規寸法へ合わせる」など目的指定を解釈
  - 提案は必ずプレビュー + 根拠 + 差分で提示
- マクロ化
  - 教科書手順をAIマクロとして保存・共有
  - プロジェクト別に再利用可能な手順ライブラリを提供
- 監査対応
  - AI適用履歴と手動編集履歴の統合トレーサビリティ
  - 出図時に変更サマリーを自動生成

**DoD**
- 「AutoCAD互換で迷わず使える」だけでなく、「AIを使うと速い」が運用で定着する。

---

## インターフェース方針（P6〜P10共通）

ユーザー提案どおり、**インターフェースは一定程度AutoCADに寄せる方が使いやすい**。
ただし完全模倣ではなく、次のハイブリッド方針を採用する。

1. **筋肉記憶を壊さない領域は互換優先**
   - コマンド入力、右クリック挙動、OSNAP表示、選択方式。
2. **AI固有価値は「追加レイヤー」で提供**
   - 既存UIを置き換えず、提案パネル・差分プレビューとして重ねる。
3. **迷ったら互換に倒す判断基準**
   - 同等価値ならAutoCAD互換。
   - 互換を崩す場合は「手順短縮・誤操作低減」の定量根拠を必須化。

---

## P6〜P10の進行管理（運用ルール）

- 各Pは「MVP → 実務検証 → 互換調整」の3フェーズで回す。
- 受け入れテストは毎回以下を含める。
  - AutoCADユーザーのブラインド操作テスト
  - AI提案の誤適用率テスト
  - Undo/Redo整合性テスト
- KPIは以下を追跡する。
  - 1図面あたり修正完了時間
  - 右クリック/ショートカット利用率
  - AI提案採用率と差し戻し率
